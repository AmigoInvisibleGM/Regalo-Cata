<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ğŸ Ruleta del Amigo Invisible</title>

<style>
body {
  margin: 0;
  background: #111;
  color: white;
  font-family: Arial, sans-serif;
  text-align: center;
}

h1 {
  margin-top: 20px;
}

.container {
  position: relative;
  width: 320px;
  margin: 30px auto;
}

canvas {
  border-radius: 50%;
  background: #222;
}

.arrow {
  width: 0;
  height: 0;
  border-left: 15px solid transparent;
  border-right: 15px solid transparent;
  border-bottom: 30px solid red;
  margin: 0 auto 10px auto;
}

button {
  margin-top: 20px;
  padding: 15px 30px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  background: gold;
  cursor: pointer;
  font-weight: bold;
}

#result {
  margin-top: 25px;
  font-size: 22px;
  font-weight: bold;
}
</style>
</head>

<body>

<h1>ğŸ„ Ruleta del Amigo Invisible ğŸ„</h1>

<div class="arrow"></div>

<div class="container">
  <canvas id="wheel" width="320" height="320"></canvas>
</div>

<button onclick="spin()">GIRAR ğŸ°</button>

<div id="result"></div>

<script>
const premios = [
  "Viaje a JapÃ³n âœˆï¸",
  "PlayStation 5 ğŸ®",
  "iPhone 15 ğŸ“±",
  "Auto 0km ğŸš—",
  "Cena gourmet ğŸ½ï¸",
  "Fin de semana ğŸ–ï¸",
  "ğŸ MEDIAS ğŸ"
];

// ğŸ¯ ESTE ES EL PREMIO QUE SIEMPRE SALE
const premioGanador = "ğŸ MEDIAS ğŸ";

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const size = canvas.width;
const center = size / 2;
const radius = center;
const angleStep = (2 * Math.PI) / premios.length;

const colors = [
  "#f44336",
  "#2196f3",
  "#4caf50",
  "#ff9800",
  "#9c27b0",
  "#03a9f4",
  "#ffc107"
];

let currentAngle = 0;

function drawWheel() {
  ctx.clearRect(0, 0, size, size);

  for (let i = 0; i < premios.length; i++) {
    const startAngle = currentAngle + i * angleStep;
    const endAngle = startAngle + angleStep;

    ctx.beginPath();
    ctx.moveTo(center, center);
    ctx.arc(center, center, radius, startAngle, endAngle);
    ctx.fillStyle = colors[i];
    ctx.fill();
    ctx.strokeStyle = "#fff";
    ctx.lineWidth = 2;
    ctx.stroke();

    // TEXTO
    ctx.save();
    ctx.translate(center, center);
    ctx.rotate(startAngle + angleStep / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#000";
    ctx.font = "bold 14px Arial";
    ctx.fillText(premios[i], radius - 10, 5);
    ctx.restore();
  }
}

drawWheel();

function spin() {
  const vueltas = 6;
  const indexGanador = premios.indexOf(premioGanador);

  const targetAngle =
    (Math.PI * 3 / 2) - (indexGanador * angleStep) - (angleStep / 2);

  const finalAngle = (vueltas * 2 * Math.PI) + targetAngle;

  const duration = 4000;
  const start = performance.now();

  function animate(time) {
    const progress = Math.min((time - start) / duration, 1);
    const ease = 1 - Math.pow(1 - progress, 3);

    currentAngle = ease * finalAngle;
    drawWheel();

    if (progress < 1) {
      requestAnimationFrame(animate);
    } else {
      document.getElementById("result").innerHTML =
        `ğŸ‰ Â¡Ganaste!<br><br>${premioGanador}`;
    }
  }

  requestAnimationFrame(animate);
}
</script>

</body>
</html>
